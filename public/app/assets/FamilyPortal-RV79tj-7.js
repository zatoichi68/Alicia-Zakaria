import{c as i,u as j,r as o,j as e,a as w}from"./index-BVaTGwHT.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]],S=i("bell-off",C);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],T=i("bell",L);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],h=i("check",_);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],M=i("copy",A);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],$=i("shield-check",q),E=()=>{const{language:b,t}=j(),[c,g]=o.useState(null),[l,n]=o.useState("idle"),[u,x]=o.useState(!1),[d,k]=o.useState(""),[m,f]=o.useState(""),[p,v]=o.useState([]),a=s=>{v(r=>[...r.slice(-4),`${new Date().toLocaleTimeString(b==="fr"?"fr-CA":"en-CA")} - ${s}`])},y=async()=>{if(!d.trim()||!m.trim()){a(t("‚ö†Ô∏è Nom ou code manquant","‚ö†Ô∏è Missing name or code"));return}a(t("üöÄ Demande de permission...","üöÄ Requesting permission...")),n("requesting");try{const s=await w();if(s){a(t("‚úÖ Token re√ßu !","‚úÖ Token received!")),g(s),n("saving"),a(t("üì° Envoi au serveur...","üì° Sending to server..."));const r=await fetch("/api/family/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessCode:m.trim(),token:s,familyName:d.trim()})});r.ok?(a(t("üéâ Liaison r√©ussie !","üéâ Link successful!")),n("success")):(a(`‚ùå API error: ${r.status}`),n("denied"))}}catch(s){a(`‚ùå Error: ${s.message}`),console.error("Registration error:",s),n("denied")}},N=()=>{c&&(navigator.clipboard.writeText(c),x(!0),setTimeout(()=>x(!1),2e3))};return e.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-950 p-6 flex flex-col items-center",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-slate-900 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-800 p-8 space-y-8",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-4 rounded-full w-fit mx-auto",children:e.jsx($,{className:"w-12 h-12 text-blue-600 dark:text-blue-400"})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:t("Espace Famille","Family Portal")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:t("Activez les notifications pour recevoir les appels vid√©o de votre proche.","Enable notifications to receive your loved one's video calls.")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-400 uppercase",children:t("Code d'acc√®s du R√©sident","Resident access code")}),e.jsx("input",{type:"text",value:m,onChange:s=>f(s.target.value),placeholder:"ex: 12345",className:"w-full p-4 rounded-2xl bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 focus:border-blue-500 outline-none transition-all dark:text-white text-center font-mono text-2xl tracking-widest"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-400 uppercase",children:t("Votre Nom","Your Name")}),e.jsx("input",{type:"text",value:d,onChange:s=>k(s.target.value),placeholder:t("ex: Sophie Dub√©","e.g. Sophie Dub√©"),className:"w-full p-4 rounded-2xl bg-slate-50 dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 focus:border-blue-500 outline-none transition-all dark:text-white"})]}),l!=="success"?e.jsx("button",{onClick:y,disabled:!d.trim()||!m.trim()||l==="requesting"||l==="saving",className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 text-white font-bold py-4 rounded-2xl text-xl flex items-center justify-center gap-3 transition-all shadow-lg active:scale-95",children:l==="requesting"?t("Permission...","Permission..."):l==="saving"?t("Liaison...","Linking..."):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-6 h-6"}),t("Lier mon t√©l√©phone","Link my phone")]})}):e.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 border-2 border-emerald-100 dark:border-emerald-800 rounded-2xl p-6 text-center space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-emerald-600 dark:text-emerald-400 font-bold text-lg",children:[e.jsx(h,{className:"w-6 h-6"}),t("Appareil Li√© !","Device linked!")]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:t("Vous recevrez une alerte sur ce t√©l√©phone d√®s que votre proche lancera un appel vid√©o.","You will receive an alert on this phone as soon as your loved one starts a video call.")})]})]}),p.length>0&&e.jsx("div",{className:"p-4 bg-slate-100 dark:bg-slate-800 rounded-xl font-mono text-xs space-y-1",children:p.map((s,r)=>e.jsx("div",{className:"text-slate-500",children:s},r))}),c&&e.jsxs("div",{className:"pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("p",{className:"text-xs font-mono text-slate-400 mb-2 truncate",children:["TOKEN: ",c]}),e.jsxs("button",{onClick:N,className:"w-full py-2 text-blue-600 dark:text-blue-400 text-sm font-medium flex items-center justify-center gap-2 hover:underline",children:[u?e.jsx(h,{className:"w-4 h-4"}):e.jsx(M,{className:"w-4 h-4"}),u?t("Copi√© !","Copied!"):t("Copier mon Token pour test","Copy my token for testing")]})]}),e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-2xl p-4 flex gap-3 items-start",children:[e.jsx(S,{className:"w-5 h-5 text-amber-600 shrink-0 mt-1"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 italic",children:t("Note: Gardez cet onglet ouvert ou ajoutez le site √† votre √©cran d'accueil pour une meilleure r√©ception.","Note: Keep this tab open or add the site to your home screen for better delivery.")})]})]})})};export{E as FamilyPortal};
